#!/usr/bin/env bash

exe=../green/green

base=empty

### generate a control file
cat > green_control.sh << EOF
################################################################
#
#   A43 control file generated by $0
#
################################################################
# use # for silent comments and #! for comments in the log file

## general verbosity of the log file
verbosity=7

## display energies in custom units {Ha, Ry, eV}
#output.energy.unit=eV
## display distances in custom units {Bohr, Ang, nm, pm}
#output.length.unit=Ang

## input Hamiltonian
green_experiments.hamiltonian.file=Hmt.$base.xml

## when reading from the xml-formatted input file 1:ignore empty potential, 0:error on empty potential
green_input.empty.potential=1

## spacing in k-space
hamiltonian.kpath.from.x=0
hamiltonian.kpath.from.y=0
hamiltonian.kpath.from.z=0
hamiltonian.kpath.to.x=0.5
hamiltonian.kpath.to.y=0
hamiltonian.kpath.to.z=0
hamiltonian.kpath.spacing=0.1

## in E-space
green_experiments.bandstructure.energy.offset=-0.2
green_experiments.bandstructure.energy.spacing=0.01
green_experiments.bandstructure.energy.points=600
green_experiments.bandstructure.energy.imag=0.005

control.show=1

EOF

(cd ../green/ && make -j) && \
echo "# start calculation $base" && \
$exe -test green_experiments \
      +control.file=green_control.sh \
      "$@" > green_experiments.$base.out
